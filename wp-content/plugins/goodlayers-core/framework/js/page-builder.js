!function(e){"use strict";var t=function(t,r,a){var o=this;o.body=e("body"),o.container=t,o.settings=e.extend({dragging_threshold:200,helper:'<div class="gdlr-core-page-builder-helper" ></div>',placeholder:{main_class:"gdlr-core-page-builder-placeholder",wrapper:"gdlr-core-page-builder-placeholder-wrapper",column:"gdlr-core-page-builder-placeholder-column",item:"gdlr-core-page-builder-placeholder-item"},item_class:{wrapper:".gdlr-core-page-builder-wrapper",column:".gdlr-core-page-builder-column",item:".gdlr-core-page-builder-item"},container_class:{wrapper:".gdlr-container-sortable",column:".gdlr-container-sortable, .gdlr-core-wrapper-sortable",item:".gdlr-container-sortable, .gdlr-core-wrapper-sortable, .gdlr-core-column-sortable"},mousedown:function(e){return!0},startdragging:function(e){},dragging:function(e,t,r){},updateposition:function(e){},enddragging:function(e){}},r),o.template=e.extend({container:null,selector:".gdlr-core-pb-list-draggable",item_type:function(e){return"wrapper"},template_item:function(e){return e.clone()}},a),o.is_dragging=!1,o.current_item=null,o.current_item_type="",o.target=null,o.target_type="append",o.helper=null,o.placeholder=null,o.init()};t.prototype={init:function(){var e=this;for(var t in e.draggable_class="",e.settings.item_class)""!=e.draggable_class&&(e.draggable_class+=", "),e.draggable_class+=e.settings.item_class[t];e.bindContainer()},bindContainer:function(){var t,r=this,a=e(window).height(),o=0;e(window).resize(function(){a=e(window).height()}),null!=r.template.container&&r.template.container.on("mousedown",r.template.selector,function(a){null==r.current_item&&1==a.which&&r.settings.mousedown(a)&&(r.is_dragging=!0,r.current_item=e(this),r.current_item_type=r.template.item_type(r.current_item),r.body.addClass("gdlr-core-no-selection"),t=(new Date).getTime())}),r.container.on("mousedown",function(l){if(null==r.current_item&&1==l.which&&r.settings.mousedown(l)){r.is_dragging=!0,r.current_item=e(l.target).closest(r.draggable_class),r.current_item.addClass("gdlr-core-item-dragging"),r.current_item_type=r.check_item_type(r.current_item),r.body.addClass("gdlr-core-no-selection"),t=(new Date).getTime(),o=l.clientY;var i=setInterval(function(){r.is_dragging?0==t&&(o<.15*a?e("html, body").scrollTop(e(window).scrollTop()-10):o>.85*a&&e("html, body").scrollTop(e(window).scrollTop()+10)):clearInterval(i)},15)}}),e("body").on("mousemove",function(a){if(1==a.which&&(o=a.clientY,r.is_dragging))if(0==t){r.set_helper(a.pageX,a.pageY);var l=e(a.target).closest(r.settings.container_class[r.current_item_type]),i=l.children();0==(i=(i=i.not("."+r.settings.placeholder.main_class)).not(".gdlr-core-item-dragging")).length?l.length>0?(r.target=l,r.target_type="append"):r.target=null:i.each(function(){var t=e(this).offset(),o=e(this).outerWidth(),l=e(this).outerHeight();if(r.target=e(this),a.pageX>=t.left&&a.pageX<=t.left+o&&a.pageY>=t.top&&a.pageY<=t.top+l)return"column"==r.check_item_type(e(this))?a.pageX<=t.left+o/2?r.target_type="before":r.target_type="after":a.pageY<=t.top+l/2?r.target_type="before":r.target_type="after",!1;if("column"==r.check_item_type(e(this)))if(a.pageY>t.top+l)r.target_type="after";else{if(a.pageX<=t.left+o/2)return r.target_type="before",!1;r.target_type="after"}else{if(a.pageY<=t.top+l/2)return r.target_type="before",!1;r.target_type="after"}}),r.set_placeholder(),null!=r.placeholder&&null!=r.current_item&&r.settings.dragging(a,r.current_item,r.placeholder)}else t+r.settings.dragging_threshold<(new Date).getTime()&&(t=0,r.current_item.is(r.template.selector)||r.current_item.hide(),r.settings.startdragging(a))}),e("body").on("mouseup",function(a){1==a.which&&(null!=r.target&&null!=r.current_item&&(null==r.placeholder||r.placeholder.prev().is(r.current_item)||r.placeholder.next().is(r.current_item)||(r.current_item.is(r.template.selector)&&(r.current_item=r.template.template_item(r.current_item)),"append"==r.target_type?r.target.append(r.current_item):"before"==r.target_type?r.current_item.insertBefore(r.target):"after"==r.target_type&&r.current_item.insertAfter(r.target),r.settings.updateposition())),null!=r.target&&(r.target=null),null!=r.placeholder&&(r.placeholder.remove(),r.placeholder=null),null!=r.helper&&(r.helper.remove(),r.helper=null),r.is_dragging=!1,null!=r.current_item&&(r.current_item.removeClass("gdlr-core-item-dragging"),r.current_item.show(),0!=t||r.current_item.is(r.template.selector)||r.current_item.css({opacity:0,scale:.8}).transition({opacity:1,scale:1},200,function(){e(this).css({opacity:"",transform:""})}),r.current_item=null),r.body.removeClass("gdlr-core-no-selection"),r.settings.enddragging())})},set_placeholder:function(){var t=this;null!=t.target&&null!=t.current_item&&(null==t.placeholder&&(t.placeholder=e("<div ></div>").addClass(t.settings.placeholder.main_class),t.placeholder.addClass(t.settings.placeholder[t.current_item_type]),t.body.append(t.placeholder)),"append"==t.target_type?t.target.append(t.placeholder):"before"==t.target_type?t.placeholder.insertBefore(t.target):"after"==t.target_type&&t.placeholder.insertAfter(t.target))},set_helper:function(t,r){var a=this;null==a.helper&&(a.helper=e(a.settings.helper),a.body.append(a.helper)),a.helper.css({top:r,left:t})},check_item_type:function(e){for(var t in this.settings.item_class)if(e.is(this.settings.item_class[t]))return t;return""}};var r=function(){this.pb=e("#gdlr-core-page-builder"),this.pb_val=e("#gdlr-core-page-builder-val"),this.pb_nonce=e("#page_builder_security").val(),this.pb_tip=this.pb.siblings("#gdlr-core-page-builder-tip"),this.head_nav=this.pb.find("#gdlr-core-page-builder-head-nav"),this.head_content=this.pb.find("#gdlr-core-page-builder-head-content"),this.btn_full_screen=this.head_nav.find("#gdlr-core-page-builder-head-full-screen"),this.btn_reset=this.pb.find("#gdlr-core-page-builder-head-action-reset"),this.btn_save_template=this.pb.find("#gdlr-core-page-builder-head-action-save-template"),this.btn_view_mode=this.pb.find("#gdlr-core-page-builder-head-action-mode-section"),this.btn_live_mode=this.pb.find("#gdlr-core-page-builder-head-action-live-mode, #gdlr-core-page-builder-head-action-live-mode-alt"),this.content_stack=[],this.content_stack_active=-1,this.btn_undo=this.pb.find("#gdlr-core-page-builder-head-action-undo"),this.btn_redo=this.pb.find("#gdlr-core-page-builder-head-action-redo"),this.body_content=this.pb.children("#gdlr-core-page-builder-body"),this.body_container=this.body_content.children("#gdlr-core-page-builder-container"),this.init()};r.prototype={init:function(){var t=this;t.bind_fixed_nav(),t.bind_head_nav(),t.bind_head_action(),t.bind_full_screen(),t.bind_view_mode(),t.bind_wrapper_action(),t.bind_column_action(),t.bind_item_action(),t.body_content.find(".gdlr-core-page-builder-item-container-preview").find("a").attr("href","#gdlr-pb-link").off(),"undefined"!=typeof Strip&&Strip.disable(),t.bind_container_area(t.body_content),t.sortable_column_order(),e("#post-preview, #publish, #save-post").click(function(){t.pb_update()}),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.registerPlugin&&(YoastSEO.app.registerPlugin("gdlrCorePB",{status:"ready"}),YoastSEO.app.registerModification("content",e.proxy(t.get_seo_content,t),"gdlrCorePB",5)),t.pb.on("gdlr-core-element-change",function(){t.pb.trigger("gdlr-core-element-resize"),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.pluginReloaded&&YoastSEO.app.pluginReloaded("gdlrCorePB")}),t.pb_tip.length>0&&t.pb.on("gdlr-core-show-tooltip",function(r){t.pb_tip.siblings(".gdlr-core-page-builder-tip");t.pb_tip.fadeIn(400),t.pb_tip.find(".gdlr-core-page-builder-tip-dismiss").click(function(){t.pb_tip.fadeOut(400,function(){e(this).remove()})}),t.pb.unbind("gdlr-core-show-tooltip",r.handleObj.handler,r),t.ajax_pb_update_option("gdlr-core-page-builder-tip",1)})},get_seo_content:function(t){return this.pb.find(".gdlr-core-page-builder-item-container-preview").each(function(){t+=e(this).children().not("script, style").html()}),t},pb_update:function(){var t=this,r=[];t.body_container.children("[data-template]").each(function(){r.push(t.pb_update_tempalte_val(e(this)))}),t.pb_val.val(JSON.stringify(r))},pb_update_tempalte_val:function(t){var r=this,a={};(a.template=t.attr("data-template"),a.type=t.attr("data-type"),t.attr("data-column")&&(a.column=t.attr("data-column")),t.data("value")&&(a.value=t.data("value")),"wrapper"==t.attr("data-template"))&&("background"==t.attr("data-type")?t.children(".gdlr-core-page-builder-wrapper-content").children(".gdlr-core-page-builder-wrapper-content-margin").children(".gdlr-core-page-builder-wrapper-content-wrap").children().children(".gdlr-core-page-builder-wrapper-container"):"sidebar"==t.attr("data-type")?t.children().children(".gdlr-core-page-builder-wrapper-sidebar-container").children(".gdlr-core-page-builder-wrapper-sidebar-content").children():t.children(".gdlr-core-page-builder-column-content").children(".gdlr-core-page-builder-column-content-margin").children(".gdlr-core-page-builder-column-content-wrap").children(".gdlr-core-page-builder-column-container")).children("[data-template]").each(function(){a.items||(a.items=[]),a.items.push(r.pb_update_tempalte_val(e(this)))});return a},update_undo_stack:function(e){e||(this.content_stack_active>=page_builder_var.settings.undo_times?this.content_stack.shift():(this.content_stack_active++,this.content_stack.splice(this.content_stack_active,page_builder_var.settings.undo_times))),this.content_stack[this.content_stack_active]=this.body_container.children().gdlr_core_clone()},update_undo_content:function(){this.body_container.html(this.content_stack[this.content_stack_active])},bind_view_mode:function(){var t=this;t.btn_view_mode.children(".gdlr-core-page-builder-head-action-mode").click(function(){var r=e(this).attr("data-mode");t.body_content.attr("data-mode")!=r&&(t.btn_view_mode.attr("data-mode",r),t.body_content.attr("data-mode",r),t.btn_live_mode.attr("data-mode",r),"live"==r?t.body_content.addClass("gdlr-core-pb-livemode").removeClass("gdlr-core-pb-blockmode"):t.body_content.addClass("gdlr-core-pb-blockmode").removeClass("gdlr-core-pb-livemode"),t.pb.trigger("gdlr-core-element-resize"),t.ajax_pb_update_option("gdlr-core-page-builder-view-mode",r))}),t.btn_live_mode.children().click(function(){if(!e(this).hasClass("gdlr-core-active")){var r=e(this).attr("data-live-mode");t.btn_live_mode.children('[data-live-mode="'+r+'"]').addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),"edit"==r?t.body_content.removeClass("gdlr-core-live-preview").addClass("gdlr-core-live-edit"):t.body_content.removeClass("gdlr-core-live-edit").addClass("gdlr-core-live-preview"),t.pb.trigger("gdlr-core-element-resize")}});var r=e(t.get_live_mode_container_css()).appendTo("body");e(window).resize(function(){r.remove(),r=e(t.get_live_mode_container_css()).appendTo("body")})},get_live_mode_container_css:function(){var e=(this.body_content.width()-this.body_container.width())/2;return'<style type="text/css">'+(".gdlr-core-pb-livemode .gdlr-core-page-builder-wrapper{margin-left:-"+e+"px; margin-right:-"+e+"px}")+"</style>"},bind_fixed_nav:function(){var t,r,a=this,o=a.pb.children(".gdlr-core-page-builder-head"),l=a.pb.children(".gdlr-core-page-builder-head-sub");e(window).scroll(function(){if(o.hasClass("gdlr-core-fixed"))if(e(window).scrollTop()+32<a.pb.offset().top+l.height()+0){var i=o.clone();i.insertAfter(o),i.slideUp(200,function(){e(this).remove()}),l.css("height",""),a.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),a.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),t.addClass("gdlr-core-active"),r.addClass("gdlr-core-active").show(),o.removeClass("gdlr-core-fixed").css({width:"",display:"block"})}else e(window).scrollTop()+0>a.pb.offset().top+a.pb.outerHeight()?o.addClass("gdlr-core-outside").slideUp(200):o.hasClass("gdlr-core-outside")&&o.removeClass("gdlr-core-outside").slideDown(200);else e(window).scrollTop()+32>=a.pb.offset().top+o.outerHeight()+0&&e(window).scrollTop()+0<a.pb.offset().top+a.pb.outerHeight()&&(l.css("height",o.outerHeight()),t=a.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),r=a.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),o.addClass("gdlr-core-fixed").css({display:"none",width:a.pb.outerWidth()}).slideDown(200))}),e(window).resize(function(){o.hasClass("gdlr-core-fixed")&&o.css({width:a.pb.outerWidth()})}),a.btn_full_screen.click(function(){o.hasClass("gdlr-core-fixed")&&o.hide()})},bind_head_nav:function(){var t=this;t.head_nav.children(".gdlr-core-page-builder-head-nav-item").click(function(){var r=e(this).attr("data-nav-type");e(this).hasClass("gdlr-core-active")?(e(this).removeClass("gdlr-core-active"),t.head_content.children('[data-content-type="'+r+'"]').removeClass("gdlr-core-active").css("display","block").slideUp(150)):(e(this).addClass("gdlr-core-active"),e(this).siblings(".gdlr-core-page-builder-head-nav-item").removeClass("gdlr-core-active"),t.head_content.children(".gdlr-core-active").length?(t.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),t.head_content.children('[data-content-type="'+r+'"]').addClass("gdlr-core-active").css({display:"none"}).fadeIn(150)):t.head_content.children('[data-content-type="'+r+'"]').addClass("gdlr-core-active").css({display:"none"}).slideDown(150))}),t.head_content.on("input",".gdlr-core-page-builder-head-content-search",gdlr_core_debounce(function(){var t=e(this).val();t.length>0?e(this).siblings().children(".gdlr-core-pb-list-draggable").each(function(){e(this).is('[data-title*="'+t+'"], [data-type*="'+t+'"]')?e(this).css({display:"block"}):e(this).css({display:"none"})}):e(this).siblings().children(".gdlr-core-pb-list-draggable").css({display:"block"})},300)),t.head_content.find(".gdlr-core-template-type-button").click(function(){if(!e(this).hasClass("gdlr-core-active")){e(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active");var t=e(this).attr("data-type");e(this).parent().siblings(".gdlr-core-page-builder-head-content-template-container").each(function(){e(this).attr("data-type")==t?e(this).addClass("gdlr-core-active").css({display:"none"}).fadeIn(150):e(this).removeClass("gdlr-core-active").hide()})}}),t.bind_head_nav_click(),t.head_content.on("click",".gdlr-core-page-builder-head-content-custom-template-remove",function(){var r=e(this).closest(".gdlr-core-page-builder-head-content-custom-template-item");return gdlr_core_confirm_box({success:function(){t.ajax_get_template(null,{data:{security:t.pb_nonce,action:"gdlr_core_remove_pb_custom_template",slug:r.attr("data-template-slug")},success:function(t){"failed"==t.status&&(template.slideUp(200,function(){e(this).remove()}),gdlr_core_alert_box({status:t.status,head:t.head,message:t.message}))}}),r.fadeOut(200,function(){e(this).remove()})}}),!1})},bind_head_nav_click:function(){var t=this;t.head_content.on("click",".gdlr-core-pb-list-draggable",function(r){if(!e(r.target).is(".fa-remove")){var a=t.get_template(e(this));t.body_container.append(a),t.update_undo_stack(),a.css({opacity:0,scale:.8}).transition({opacity:1,scale:1},200,function(){e(this).css({opacity:"",transform:""})}),gdlr_core_alert_box({status:"success",head:page_builder_var.text.item_added,duration:1e3}),t.pb.trigger("gdlr-core-show-tooltip"),t.sortable_column_order()}})},bind_full_screen:function(){var t=this,r=e("#wpwrap"),a=(e("#wpadminbar"),t.pb.parent());t.btn_full_screen.click(function(){e(this).hasClass("gdlr-core-active")?(e(this).removeClass("gdlr-core-active"),r.css({display:""}),e("html").css({"padding-top":""}),a.append(t.pb),t.pb.removeClass("gdlr-core-fullscreen"),e(window).scrollTop(t.pb.offset().top).trigger("resize").trigger("scroll")):(e(this).addClass("gdlr-core-active"),r.css({display:"none"}),e("html").css({"padding-top":0}),e("body").append(t.pb.addClass("gdlr-core-fullscreen")),e("html, body").scrollTop(0).trigger("resize").trigger("scroll"))}),t.head_nav.find(".gdlr-core-page-builder-head-nav-update").click(function(){if(!e(this).hasClass("gdlr-core-now-loading")){var r=e(this).addClass("gdlr-core-now-loading"),a=e(this).attr("data-post-id"),o=[];t.body_container.children().each(function(){o.push(t.pb_update_tempalte_val(e(this)))}),e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:t.pb_nonce,action:"gdlr_core_save_page_builder_data",post_id:a,value:JSON.stringify(o)},dataType:"json",error:function(e,t,a){r.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,a)},success:function(e){r.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}})}})},get_template:function(t){var r=this,a="";if("wrapper"==t.attr("data-template")){if("column"==t.attr("data-type")){var o=t.attr("data-column");(a=e(page_builder_var.template.column)).addClass("gdlr-core-column-"+o).attr("data-column",o),a.find(".gdlr-core-page-builder-column-head-title").html(page_builder_var.column[o])}else a=e(page_builder_var.template[t.attr("data-type")]);r.update_element_preview(a)}else"element"==t.attr("data-template")?((a=e(page_builder_var.template.element)).attr("data-type",t.attr("data-type")),a.find(".gdlr-core-page-builder-item-container-item-title, .gdlr-core-page-builder-item-head-item-title").html(t.attr("data-title")),r.update_element_preview(a)):"template"==t.attr("data-template")?((a=e(page_builder_var.template.template)).attr("data-type",t.attr("data-type")),a.attr("data-template-slug",t.attr("data-template-slug")),r.ajax_get_template(a,{data:{security:r.pb_nonce,action:"gdlr_core_get_pb_template",slug:t.attr("data-template-slug")}})):"custom-template"==t.attr("data-template")&&((a=e(page_builder_var.template.template)).attr("data-type",t.attr("data-type")),a.attr("data-template-slug",t.attr("data-template-slug")),r.ajax_get_template(a,{data:{security:r.pb_nonce,action:"gdlr_core_get_pb_custom_template",slug:t.attr("data-template-slug")}}));return a},bind_wrapper_action:function(){var t=this;t.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-remove",function(){e(this).closest(".gdlr-core-page-builder-wrapper").fadeOut(200,function(){e(this).remove(),t.pb.trigger("gdlr-core-element-change"),t.update_undo_stack()})}),t.body_content.on("dblclick",".gdlr-core-page-builder-wrapper",function(){var r=e(this);return t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:r.attr("data-template"),type:r.attr("data-type"),value:r.data("value")}},r),!1}),t.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-edit",function(){var r=e(this).closest(".gdlr-core-page-builder-wrapper");t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:r.attr("data-template"),type:r.attr("data-type"),value:r.data("value")}},r)}),t.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-save",function(){var r=[];r.push(t.pb_update_tempalte_val(e(this).closest(".gdlr-core-page-builder-wrapper"))),t.lb_save_custom_template(r,"wrapper")}),t.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-copy",function(){var r=e(this).closest(".gdlr-core-page-builder-wrapper"),a=r.gdlr_core_clone();a.insertAfter(r),a.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){e(this).css({opacity:"",transform:""})}),t.update_undo_stack()})},bind_column_action:function(){var t=this;t.body_container.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-size i",function(){var r=e(this).closest(".gdlr-core-page-builder-column"),a=r.attr("data-column"),o=e(this).closest(".gdlr-core-page-builder-column-head").find(".gdlr-core-page-builder-column-head-title"),l=10,i=60;for(var n in page_builder_var.column)if(n<a)l=n;else if(n>a){i=n;break}e(this).hasClass("gdlr-core-page-builder-column-increase")?(a!=i&&(r.removeClass("gdlr-core-column-"+a),o.html(page_builder_var.column[i]),r.addClass("gdlr-core-column-"+i).attr("data-column",i)),t.sortable_column_order(),t.pb.trigger("gdlr-core-element-resize"),t.update_undo_stack()):e(this).hasClass("gdlr-core-page-builder-column-decrease")&&(a!=l&&(r.removeClass("gdlr-core-column-"+a),o.html(page_builder_var.column[l]),r.addClass("gdlr-core-column-"+l).attr("data-column",l)),t.sortable_column_order(),t.pb.trigger("gdlr-core-element-resize"),t.update_undo_stack())}),t.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-remove",function(){e(this).closest(".gdlr-core-page-builder-column").fadeOut(200,function(){e(this).remove(),t.sortable_column_order(),t.pb.trigger("gdlr-core-element-change"),t.update_undo_stack()})}),t.body_content.on("dblclick",".gdlr-core-page-builder-column",function(r){if(e(r.target).is(".gdlr-core-page-builder-column-increase, .gdlr-core-page-builder-column-decrease"))return!1;var a=e(this);return t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:a.attr("data-template"),type:a.attr("data-type"),value:a.data("value")}},a),!1}),t.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-edit",function(){var r=e(this).closest(".gdlr-core-page-builder-column");t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:r.attr("data-template"),type:r.attr("data-type"),value:r.data("value")}},r)}),t.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-save",function(){var r=[];r.push(t.pb_update_tempalte_val(e(this).closest(".gdlr-core-page-builder-column"))),t.lb_save_custom_template(r,"column")}),t.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-copy",function(){var r=e(this).closest(".gdlr-core-page-builder-column"),a=r.gdlr_core_clone();a.insertAfter(r),a.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){e(this).css({opacity:"",transform:""})}),t.sortable_column_order(),t.update_undo_stack()})},bind_item_action:function(){var t=this;t.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-remove",function(){e(this).closest(".gdlr-core-page-builder-item").fadeOut(200,function(){e(this).remove(),t.pb.trigger("gdlr-core-element-change"),t.update_undo_stack()})}),t.body_content.on("dblclick",".gdlr-core-page-builder-item",function(){var r=e(this);return t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:r.attr("data-template"),type:r.attr("data-type"),value:r.data("value")}},r),!1}),t.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-edit",function(){var r=e(this).closest(".gdlr-core-page-builder-item");t.ajax_get_options({data:{security:t.pb_nonce,action:"gdlr_core_get_pb_options",template:r.attr("data-template"),type:r.attr("data-type"),value:r.data("value")}},r)}),t.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-save",function(){var r=[];r.push(t.pb_update_tempalte_val(e(this).closest(".gdlr-core-page-builder-item"))),t.lb_save_custom_template(r,"element")}),t.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-copy",function(){var r=e(this).closest(".gdlr-core-page-builder-item"),a=r.gdlr_core_clone();a.insertAfter(r),a.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){e(this).css({opacity:"",transform:""})}),t.update_undo_stack()})},bind_head_action:function(){var t=this;t.update_undo_stack(),t.btn_undo.click(function(){t.content_stack_active>0?(t.content_stack_active--,t.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.undo_end})}),t.btn_redo.click(function(){void 0!==t.content_stack[t.content_stack_active+1]?(t.content_stack_active++,t.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.redo_end})}),t.btn_reset.click(function(){gdlr_core_confirm_box({success:function(){t.body_container.empty(),t.update_undo_stack()},sub:""})}),t.btn_save_template.click(function(){var r=[];t.body_container.children().each(function(){r.push(t.pb_update_tempalte_val(e(this)))}),t.lb_save_custom_template(r,"wrapper")}),t.btn_save_template.contextmenu(function(){var r=[];t.body_container.children().each(function(){r.push(t.pb_update_tempalte_val(e(this)))}),console.log(JSON.stringify(r))})},ajax_pb_update_option:function(t,r){void 0!==t&&void 0!==r&&e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_pb_update_option",slug:t,value:r},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(e){void 0!==e&&e&&console.log(e)}})},ajax_get_options:function(t,r){var a=this,o=e('<div class="gdlr-core-page-builder-loading" ></div>'),l=e.extend({beforeSend:function(e,t){var r=a.pb.offset().left+a.pb.outerWidth()/2;o.css({display:"none",left:r}).appendTo("body"),o.fadeIn(150)},error:function(e,t,r){o.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){o.remove(),"success"==e.status?a.lb_options(e.option_content,r):"failed"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}},t);e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:l.data,dataType:"json",beforeSend:l.beforeSend,error:l.error,success:l.success})},ajax_get_skin_options:function(t){var r=this,a=e('<div class="gdlr-core-page-builder-loading" ></div>');e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:r.pb_nonce,action:"gdlr_core_get_skin_options"},dataType:"json",beforeSend:function(e,t){a.css({display:"none"}).appendTo("body"),a.fadeIn(150)},error:function(e,t,r){a.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){a.remove(),"success"==e.status?r.lb_skin_options(e.option_content,t):"failed"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}})},ajax_update_skin:function(t,r){e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_update_skin",value:t,skin:r.val()},dataType:"json",error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(t){if(console.log(t),"success"==t.status){if(console.log(t),void 0!==t.combobox&&r.html(t.combobox),void 0!==t.style){var a=e("#gdlr-core-skin-style-temp");a.length||(a=e('<style type="text/css" id="gdlr-core-skin-style-temp" ></style>'),e("body").append(a)),a.html(t.style)}}else"failed"==t.status&&gdlr_core_alert_box({status:t.status,head:t.head,message:t.message})}})},ajax_get_template:function(t,r){var a=this,o=e.extend({error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(r){if("success"==r.status){var o=e(r.content);t.replaceWith(o),a.pb.trigger("gdlr-core-element-change"),a.update_undo_stack(!0)}else"failed"==r.status&&(t.slideUp(200,function(){e(this).remove()}),gdlr_core_alert_box({status:r.status,head:r.head,message:r.message}))}},r);e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:o.data,dataType:"json",beforeSend:o.beforeSend,error:o.error,success:o.success})},ajax_save_template:function(t,r){var a=e.extend({error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){"success"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message}),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}},r);e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:a.data,dataType:"json",beforeSend:a.beforeSend,error:a.error,success:a.success})},update_element_preview:function(t){var r=this;t.find(".gdlr-core-page-builder-item-container-preview").each(function(){var t=e(this).closest(".gdlr-core-page-builder-item"),a=e(this).addClass("gdlr-core-now-loading");e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:r.pb_nonce,action:"gdlr_core_get_pb_element_preview",type:t.attr("data-type"),value:t.data("value")},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(t){if(a.removeClass("gdlr-core-now-loading"),"success"==t.status&&t.preview_content){var o=e(t.preview_content);o.find("a").attr("href","#gdlr-pb-link").removeClass("gdlr-core-ilightbox"),a.html(o),r.pb.trigger("gdlr-core-element-change"),r.update_undo_stack(!0)}}})})},update_wrapper_preview:function(t){var r=this.pb_update_tempalte_val(t);t.addClass("gdlr-core-now-loading"),e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_get_pb_wrapper_preview",type:t.attr("data-type"),value:r},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(r){if(t.removeClass("gdlr-core-now-loading"),"success"==r.status&&r.preview_content){var a=e(r.preview_content);t.replaceWith(a)}}})},lb_save_custom_template:function(t,r){var a=this,o=e(page_builder_var.template.custom_template_lb);e("body").append(o),o.css({opacity:0}).animate({opacity:1},200),o.find(".gdlr-core-custom-template-lb-head-close").click(function(){o.animate({opacity:0},200,function(){e(this).remove()})}),o.find(".gdlr-core-custom-template-save").click(function(){var l=e(this).siblings(".gdlr-core-custom-template-name").val();""==l?gdlr_core_alert_box({status:"failed",head:page_builder_var.template.custom_template_no_text_head,message:page_builder_var.template.custom_template_no_text_message}):(o.animate({opacity:0},200,function(){e(this).remove()}),e.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:a.pb_nonce,action:"gdlr_core_save_pb_custom_template",value:t,type:r,title:l},dataType:"json",error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(t){if("success"==t.status){var r=e(t.nav_item);a.head_content.children('[data-content-type="custom-template"]').find(".gdlr-core-page-builder-head-content-custom-template-container").append(r)}gdlr_core_alert_box({status:t.status,head:t.head,message:t.message})}}))})},lb_options:function(t,r){var a=this,o=e('<div class="gdlr-core-lightbox-content-wrapper"></div>'),l=e('<div class="gdlr-core-lightbox-content"></div>');o.append(l),l.append(t),e("body").append(o).css({overflow:"hidden",width:e("body").width()}),o.css({opacity:0}).animate({opacity:1},400);var i=new gdlrCoreHtmlOption(l);l.find(".gdlr-core-html-option-skin-edit").click(function(){var t=e(this).siblings(".gdlr-core-html-option-item-input").find("select");a.ajax_get_skin_options(t)});var n=l.find("#gdlr-core-page-builder-options-tab-head"),c=l.find("#gdlr-core-page-builder-options-tab-content");n.children(".gdlr-core-page-builder-options-tab-head-item").click(function(){if(!e(this).hasClass("gdlr-core-active")){var t=e(this).attr("data-tab-slug");e(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),c.find('[data-tab-slug="'+t+'"]').fadeIn(200).siblings().css("display","none")}}),l.find("#gdlr-core-page-builder-options-head-close").click(function(){o.fadeOut(200,function(){e(this).remove(),e("body").css({overflow:"",width:""})})});var d=l.find("#gdlr-core-page-builder-options-save");d.click(function(){var t=i.get_val();r.data("value",t),o.fadeOut(200,function(){e(this).remove(),e("body").css({overflow:"",width:""})}),a.update_undo_stack(),r.is(".gdlr-core-page-builder-item")?a.update_element_preview(r):r.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-column")&&a.update_wrapper_preview(r)});var s=!1;l.children().click(function(){s=!0}),o.click(function(){s||d.trigger("click"),s=!1})},lb_skin_options:function(t,r){var a=this,o=e('<div class="gdlr-core-lightbox-content-wrapper gdlr-core-lightbox-skin-content-wrapper"></div>'),l=e('<div class="gdlr-core-lightbox-content"></div>');o.append(l),l.append(t),e("body").append(o),o.css({opacity:0}).animate({opacity:1},400);var i=new gdlrCoreHtmlOption(l);l.find("#gdlr-core-page-builder-options-head-close").click(function(){o.fadeOut(200,function(){e(this).remove()})});var n=l.find("#gdlr-core-page-builder-options-save");n.click(function(){var t=i.get_val();a.ajax_update_skin(t,r),o.fadeOut(200,function(){e(this).remove()})});var c=!1;l.children().click(function(){c=!0}),o.click(function(){c||n.trigger("click"),c=!1})},bind_container_area:function(e){var r=this;new t(e,{mousedown:function(e){return!r.body_content.is(".gdlr-core-pb-livemode.gdlr-core-live-preview")},startdragging:function(e){r.sortable_column_order(),r.pb.addClass("gdlr-core-dragging"),r.body_content.removeClass("gdlr-core-no-dragging")},dragging:function(e,t,r){r.removeClass("gdlr-core-placeholder-clear");for(var a=r.prev();a.length>0&&"none"==a.css("display");)a=a.prev();a.length>0&&(a.hasClass("gdlr-core-last-row")||a.hasClass("gdlr-core-last-item")&&!t.is('.gdlr-core-page-builder-column, [data-type="column"]'))&&r.addClass("gdlr-core-placeholder-clear")},updateposition:function(e){r.update_undo_stack()},enddragging:function(e){r.sortable_column_order(),r.update_undo_stack(!0),r.pb.removeClass("gdlr-core-dragging"),r.body_content.addClass("gdlr-core-no-dragging"),r.pb.trigger("gdlr-core-element-resize"),r.pb.trigger("gdlr-core-show-tooltip")}},{container:r.head_content,item_type:function(e){return"wrapper"==e.attr("data-template")?"column"==e.attr("data-type")?"column":"wrapper":"element"==e.attr("data-template")?"item":"wrapper"},template_item:function(e){return r.get_template(e)}})},sortable_column_order:function(){var t=0;this.body_content.find(".gdlr-core-page-builder-column").removeClass("gdlr-core-last-row gdlr-core-last-item gdlr-core-first").each(function(){if("none"!=e(this).css("display")){for(var r=e(this).prev();"none"==r.css("display")||r.hasClass("gdlr-core-page-builder-placeholder");)r=r.prev();0!=t&&r.is(".gdlr-core-page-builder-column")||(e(this).addClass("gdlr-core-first"),t=0),(t+=parseInt(e(this).attr("data-column")))%60==0?(e(this).addClass("gdlr-core-last-row"),t=0):t>60&&(e(this).addClass("gdlr-core-first"),t=parseInt(e(this).attr("data-column")));for(var a=e(this).next();a.length>0&&("none"==a.css("display")||a.hasClass("gdlr-core-page-builder-placeholder"));)a=a.next();0!=a.length&&a.is(".gdlr-core-page-builder-column")||e(this).addClass("gdlr-core-last-item")}})}},e(document).ready(function(){new r})}(jQuery);